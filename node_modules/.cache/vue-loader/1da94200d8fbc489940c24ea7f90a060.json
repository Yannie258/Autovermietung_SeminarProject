{"remainingRequest":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js??ref--0-1!C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\src\\components\\BestellungenKu.vue?vue&type=style&index=0&id=6d7be8b0&scoped=true&lang=css","dependencies":[{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\src\\components\\BestellungenKu.vue","mtime":1609925868204},{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\node_modules\\@vue\\cli-service\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:DQpwew0KICAgIGNvbG9yOndoaXRlOw0KICAgIHRleHQtYWxpZ246IGNlbnRlcjsNCiAgICBmb250LXNpemU6IHNtYWxsOw0KfQ0KDQouZG9wcGVsdHsNCiAgICBiYWNrZ3JvdW5kLWNvbG9yOiByZWQNCn0NCi5ub3JtYWwgew0KICAgIGJhY2tncm91bmQtY29sb3I6IHdoaXRlDQp9DQp0YWJsZSwgdGgsIHRkIHsNCiAgYm9yZGVyOiAxcHggc29saWQgYmxhY2s7DQogIGJvcmRlci1jb2xsYXBzZTogY29sbGFwc2U7DQogIHBhZGRpbmc6IDE1cHg7DQogIGJvcmRlci1zcGFjaW5nOiA1cHg7DQogIHdpZHRoOiAxMDAlOw0KfQ0KYnV0dG9uew0KICAgIGJveC1zaGFkb3c6IDBweCAwcHggMHB4IDJweCAjOWZiNGYyOw0KCWJhY2tncm91bmQ6bGluZWFyLWdyYWRpZW50KHRvIGJvdHRvbSwgIzc4OTJjMiA1JSwgIzQ3NmU5ZSAxMDAlKTsNCgliYWNrZ3JvdW5kLWNvbG9yOiM3ODkyYzI7DQoJYm9yZGVyLXJhZGl1czoxMHB4Ow0KCWJvcmRlcjoxcHggc29saWQgIzRlNjA5NjsNCglkaXNwbGF5OmlubGluZS1ibG9jazsNCgljdXJzb3I6cG9pbnRlcjsNCgljb2xvcjojZmZmZmZmOw0KCWZvbnQtZmFtaWx5OkFyaWFsOw0KCWZvbnQtc2l6ZToxNHB4Ow0KCXBhZGRpbmc6MjBweCA0MHB4IDIwcHg7DQoJdGV4dC1kZWNvcmF0aW9uOm5vbmU7DQoJdGV4dC1zaGFkb3c6MHB4IDFweCAwcHggIzI4Mzk2NjsNCiAgICBhbGlnbi1jb250ZW50OiBjZW50ZXI7DQogICAgd2lkdGg6IDIwJTsNCn0NCg0K"},{"version":3,"sources":["C:\\Users\\coanh\\OneDrive\\Documents\\SW-Projekt\\Auto\\Autovermietung\\Autovermietung\\src\\components\\BestellungenKu.vue"],"names":[],"mappings":"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","file":"C:/Users/coanh/OneDrive/Documents/SW-Projekt/Auto/Autovermietung/Autovermietung/src/components/BestellungenKu.vue","sourceRoot":"","sourcesContent":["<template>\r\n    <div>\r\n        <div v-if=\"!ausgewaehlt\">\r\n            <h1>{{msg}}</h1>\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th>BNR</th>\r\n                        <th>Startdatum</th>\r\n                        <th>Enddatum</th>\r\n                        <th>Auto</th>\r\n                        <th>Erstelldatum</th>\r\n                        <th>Status</th>\r\n                        <th>Details</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(bestellung, index) in bestellungen\" :key=\"index\">\r\n                        <td>{{bestellung.bnr}}</td>\r\n                        <td>{{bestellung.startdatum}}</td>\r\n                        <td>{{bestellung.enddatum}}</td>\r\n                        <td>{{bestellung.auto_fk}}</td>\r\n                        <td>{{bestellung.zeitstempel}}</td>\r\n                        <td>{{status(bestellung.status)}}</td>\r\n                        <td><button @click=\"showOrder(bestellung.bnr)\">Weiter</button></td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n        </div>\r\n        <div v-else>\r\n            <h1>{{msg}}</h1>\r\n            <br /> <h3>Auto: {{gewaehlteBestellung.auto_fk}}</h3>\r\n            <br /> <h3>Mietzeitraum: {{gewaehlteBestellung.startdatum}} - {{gewaehlteBestellung.enddatum}}</h3>\r\n            <table>\r\n                <thead>\r\n                    <tr>\r\n                        <th>Kosten</th>\r\n                        <th>Beschreibung</th>\r\n                    </tr>\r\n                </thead>\r\n                <tbody>\r\n                    <tr v-for=\"(kosten, index) in bestellkosten\" :key=\"index\">\r\n                        <td>{{kosten.menge}}€</td>\r\n                        <td>{{kosten.beschreibung}}</td>\r\n                    </tr>\r\n                </tbody>\r\n            </table>\r\n            <br /> <h3>Gesamtkosten: {{gesamtkosten}}€</h3>   \r\n            <button type=\"cancel\" @click=\"back\">Zurueck zur Uebersicht</button>\r\n            <button @click=\"abbrechen\"  :disabled=isDisabled>Abbrechen</button>\r\n         </div>\r\n    </div>\r\n</template>\r\n\r\n\r\n<script>\r\n// Hier wird fuer Mitarbeiter/Admin alles bzgl. Bestellungen angezeigt/definiert\r\nimport UserService from \"../services/user.service\";\r\nimport Helper from \"../services/helper.service\";\r\nimport Auth from \"../services/auth.service\";\r\nexport default {\r\n    data(){\r\n        return{\r\n            ausgewaehlt: false,\r\n            msg: '',\r\n            bestellungen: [],\r\n            gewaehlteBestellung: '',\r\n            bestellkosten: []\r\n        }\r\n    },\r\n    methods: {\r\n        // zurueck zur allgemeinen Bestellueubersicht\r\n        back() {\r\n            this.ausgewaehlt = false;\r\n            this.msg = \"Alle Bestellungen\"\r\n            this.holeBestellungen();\r\n            this.$router.push(\"/dashboard/bestellungen\")\r\n        },\r\n        // bestellung abbrechen\r\n        abbrechen() {\r\n            let heute = new Date()\r\n            let start = new Date(this.gewaehlteBestellung.startdatum)\r\n            let oneDay = 24*60*60*1000; // hours*minutes*seconds*milliseconds\r\n            let diffDays = Math.floor((start.getTime() - heute.getTime())/(oneDay))\r\n            if(confirm(\"Meochten Sie die Bestellung wirklich abbrechen?\")){\r\n                if(diffDays < 8){\r\n                    let zeit = new Date(this.gewaehlteBestellung.zeitstempel)\r\n                    diffDays = Math.floor((heute.getTime() - zeit.getTime())/(oneDay))\r\n                    if(diffDays < 4){\r\n                        this.gewaehlteBestellung.status = 3\r\n                        Auth.updateStatusOrder(this.$route.params.bnr, 3)\r\n                            .then((response) =>{\r\n                        if(response.data.success){\r\n                            alert(\"Bestellung wurde erfolgreich abgebrochen.\")\r\n                            this.ausgewaehlt = false;\r\n                            this.msg = \"Alle Bestellungen\"\r\n                            Helper.redirect(\"/dashboard/bestellungen\");\r\n                        }\r\n                        })\r\n                        .catch((error) => {\r\n                            Helper.handle(error)\r\n                            this.ausgewaehlt = false;\r\n                            this.msg = \"Alle Bestellungen\"\r\n                            Helper.redirect(\"/dashboard/bestellungen\");\r\n                        })\r\n                    }\r\n                    else{\r\n                         //Strafe in Form von 10% der Bestellkosten des zu mietenden Autos \r\n                        let kosten = 0\r\n                        for(let i =0; i< this.bestellkosten.length; i++){\r\n                            if(this.bestellkosten[i].typ == 0){\r\n                                kosten = this.bestellkosten[i].menge\r\n                            }\r\n                        }\r\n                         if(confirm(\"Sind Sie sicher? Es wird wegen der kurzfristign Absage eine Strafzahlung in Hoehe von \" + ((kosten/100)*10) + \"€ faellig\")){\r\n                            this.gewaehlteBestellung.status = 2\r\n                            Auth.updateStatusOrder(this.$route.params.bnr, 2)\r\n                                .then((response) =>{\r\n                                    if(response.data.success){\r\n                                          Auth.addCost(this.$route.params.bnr, 5, ((kosten/100)*10), 'Strafkosten fuer kurzfristiges Abbrechen')\r\n                                            .then((response) =>{\r\n                                                if(response.data.success){\r\n                                                    alert(\"Bestellung wurde abgebrochen. Jedoch muessen Sie eine Strafe zahlen\")\r\n                                                    this.ausgewaehlt = false;\r\n                                                    this.msg = \"Alle Bestellungen\"\r\n                                                    Helper.redirect(\"/dashboard/bestellungen\");\r\n                                                }\r\n                                            })\r\n                                            .catch((error) => {\r\n                                                Helper.handle(error)\r\n                                                this.ausgewaehlt = false;\r\n                                                this.msg = \"Alle Bestellungen\"\r\n                                                Helper.redirect(\"/dashboard/bestellungen\");\r\n                                             })\r\n                                    }\r\n                                 })\r\n                                 .catch((error) => {\r\n                                    Helper.handle(error)\r\n                                    this.ausgewaehlt = false;\r\n                                    this.msg = \"Alle Bestellungen\"\r\n                                    Helper.redirect(\"/dashboard/bestellungen\");\r\n                            })\r\n                         }\r\n                    }\r\n                }\r\n                else{\r\n                    this.gewaehlteBestellung.status = 3\r\n                    Auth.updateStatusOrder(this.$route.params.bnr, 3)\r\n                    .then((response) =>{\r\n                        if(response.data.success){\r\n                            alert(\"Bestellung wurde erfolgreich abgebrochen.\")\r\n                            this.ausgewaehlt = false;\r\n                            this.msg = \"Alle Bestellungen\"\r\n                            Helper.redirect(\"/dashboard/bestellungen\");\r\n                        }\r\n                    })\r\n                    .catch((error) => {\r\n                        Helper.handle(error)\r\n                        this.ausgewaehlt = false;\r\n                        this.msg = \"Alle Bestellungen\"\r\n                        Helper.redirect(\"/dashboard/bestellungen\");\r\n                    })\r\n                }\r\n            }\r\n        },\r\n        // zur detaillierten Bestellübersicht wechseln\r\n        showOrder(bnr){\r\n            this.ausgewaehlt = true;\r\n            this.msg = \"Bestellung: \" + bnr\r\n            this.gewaehlteBestellung = this.bestellungen.find(\r\n            (element) => element.bnr == bnr)\r\n            this.bestellkosten = []\r\n            UserService.getOrderCost(bnr)\r\n            .then((response) => {\r\n                response.data.costs.forEach((cost) => {\r\n                    this.bestellkosten.push(cost)\r\n                })\r\n                this.$router.push(\"/dashboard/bestellungen/\" + bnr)\r\n            })\r\n            .catch((error) => {\r\n                Helper.handle(error)\r\n                this.ausgewaehlt = false;\r\n                this.msg = \"Alle Bestellungen\"\r\n                Helper.redirect(\"/dashboard/bestellungen/\");\r\n            })\r\n        },\r\n        // alle bestellungen von backend holen\r\n        holeBestellungen(){\r\n            if (this.bestellungen.length < 1) {\r\n                UserService.getOrder(\"alle\")\r\n                .then((response) => {\r\n                    response.data.orders.forEach((order) => {\r\n                        this.bestellungen.push(order)\r\n                    })\r\n                })\r\n                .catch((error) => Helper.handle(error));\r\n            }\r\n        },\r\n         // status in text umwandeln\r\n          status(status) {\r\n           if(status == 0){\r\n              return 'Wartet auf Bestaetigung'\r\n           }\r\n           else if(status == 1){\r\n               return 'Laufende Bestellung'\r\n           }\r\n           else if(status == 2){\r\n               return 'Bezahlung ausstehend'\r\n           }\r\n           else if(status == 3){\r\n               return 'Abgebrochene Bestellung'\r\n           }\r\n           else if(status == 4){\r\n               return 'Erfolgreich abgeschlossene Bestellung'\r\n           }\r\n        }   \r\n    },\r\n    computed: {\r\n        isDisabled() {\r\n            let heute = new Date()\r\n            let start = new Date(this.gewaehlteBestellung.startdatum)\r\n            if (start.getTime() <= heute.getTime() || this.gewaehlteBestellung.status != 0){\r\n                return true\r\n            }\r\n            else{\r\n                return false\r\n            }\r\n        },\r\n        gesamtkosten(){\r\n            if(this.bestellkosten.length > 0){\r\n                let gesamt = 0\r\n                for(let i=0; i<this.bestellkosten.length;i++){\r\n                    if(this.gewaehlteBestellung.status == 2 && this.bestellkosten[i].typ == 0){\r\n                        continue\r\n                    }\r\n                    gesamt += this.bestellkosten[i].menge\r\n                }\r\n                return gesamt\r\n            }\r\n            else{\r\n                return ''\r\n            }\r\n        }\r\n    },\r\n    beforeMount(){\r\n        if (this.$route.params.bnr != \"\") {\r\n            this.ausgewaehlt = true\r\n            this.msg = \"Bestellung: \" + this.$route.params.bnr\r\n            UserService.getOrder(this.$route.params.bnr)\r\n                .then((response) => {\r\n                    response.data.order.doppelt = false\r\n                    this.gewaehlteBestellung = response.data.order\r\n                    this.bestellkosten = []\r\n                    UserService.getOrderCost(this.$route.params.bnr)\r\n                        .then((response) => {\r\n                            response.data.costs.forEach((cost) => {\r\n                                this.bestellkosten.push(cost)\r\n                            })\r\n                            this.$router.push(\"/dashboard/bestellungen/\" + this.$route.params.bnr)\r\n                        })\r\n                        .catch((error) => {\r\n                            Helper.handle(error)\r\n                            this.ausgewaehlt = false;\r\n                            this.msg = \"Alle Bestellungen\"\r\n                            Helper.redirect(\"/dashboard/bestellungen/\");\r\n                        })\r\n                })\r\n                .catch((error) => {\r\n                    Helper.handle(error);\r\n                    this.ausgewaehlt = false;\r\n                    this.msg = \"Alle Bestellungen\"\r\n                    Helper.redirect(\"/admin/bestellungen\")\r\n                })\r\n        }\r\n        else{\r\n            this.ausgewaehlt = false\r\n            this.msg = \"Alle Bestellungen\"\r\n            this.holeBestellungen()\r\n        }\r\n    }\r\n}\r\n \r\n</script>\r\n\r\n<style scoped>\r\np{\r\n    color:white;\r\n    text-align: center;\r\n    font-size: small;\r\n}\r\n\r\n.doppelt{\r\n    background-color: red\r\n}\r\n.normal {\r\n    background-color: white\r\n}\r\ntable, th, td {\r\n  border: 1px solid black;\r\n  border-collapse: collapse;\r\n  padding: 15px;\r\n  border-spacing: 5px;\r\n  width: 100%;\r\n}\r\nbutton{\r\n    box-shadow: 0px 0px 0px 2px #9fb4f2;\r\n\tbackground:linear-gradient(to bottom, #7892c2 5%, #476e9e 100%);\r\n\tbackground-color:#7892c2;\r\n\tborder-radius:10px;\r\n\tborder:1px solid #4e6096;\r\n\tdisplay:inline-block;\r\n\tcursor:pointer;\r\n\tcolor:#ffffff;\r\n\tfont-family:Arial;\r\n\tfont-size:14px;\r\n\tpadding:20px 40px 20px;\r\n\ttext-decoration:none;\r\n\ttext-shadow:0px 1px 0px #283966;\r\n    align-content: center;\r\n    width: 20%;\r\n}\r\n\r\n</style>\r\n"]}]}